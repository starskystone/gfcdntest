/**
 * Mars3D平台插件,结合echarts可视化功能插件  mars3d-echarts
 *
 * 版本信息：v3.6.18
 * 编译日期：2023-12-31 22:41:58
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.echarts || require('echarts')), (window.mars3d || require('mars3d'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'echarts', 'mars3d'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-echarts"] = {}, global.echarts, global.mars3d));
})(this, (function (exports, echarts, mars3d) { 
'use strict';function _0x4718(_0x39b0f7,_0x5dbaf1){const _0x4146d4=_0x4146();return _0x4718=function(_0x471813,_0xe91312){_0x471813=_0x471813-0x9e;let _0x4a819f=_0x4146d4[_0x471813];return _0x4a819f;},_0x4718(_0x39b0f7,_0x5dbaf1);}const _0x563c4e=_0x4718;(function(_0x44e8bb,_0xd3495){const _0x487f14={_0x32cfb6:0xbb,_0x48094a:0xcf,_0xfa84a8:0xbf,_0x1b4a64:0xb7},_0x7c13da=_0x4718,_0x2cd246=_0x44e8bb();while(!![]){try{const _0x21c23a=parseInt(_0x7c13da(_0x487f14._0x32cfb6))/0x1+parseInt(_0x7c13da(0x9e))/0x2+-parseInt(_0x7c13da(0xa5))/0x3*(parseInt(_0x7c13da(0xdc))/0x4)+-parseInt(_0x7c13da(0xc1))/0x5*(-parseInt(_0x7c13da(0xca))/0x6)+parseInt(_0x7c13da(_0x487f14._0x48094a))/0x7*(-parseInt(_0x7c13da(0xc6))/0x8)+parseInt(_0x7c13da(0xaa))/0x9+-parseInt(_0x7c13da(_0x487f14._0xfa84a8))/0xa*(parseInt(_0x7c13da(_0x487f14._0x1b4a64))/0xb);if(_0x21c23a===_0xd3495)break;else _0x2cd246['push'](_0x2cd246['shift']());}catch(_0x2add8a){_0x2cd246['push'](_0x2cd246['shift']());}}}(_0x4146,0xa1a2b));function _interopNamespace(_0x492526){const _0x1d7da0=_0x4718;if(_0x492526&&_0x492526['__esModule'])return _0x492526;var _0x37b347=Object['create'](null);return _0x492526&&Object['keys'](_0x492526)[_0x1d7da0(0xb6)](function(_0x4f3aad){if(_0x4f3aad!=='default'){var _0x2953d5=Object['getOwnPropertyDescriptor'](_0x492526,_0x4f3aad);Object['defineProperty'](_0x37b347,_0x4f3aad,_0x2953d5['get']?_0x2953d5:{'enumerable':!![],'get':function(){return _0x492526[_0x4f3aad];}});}}),_0x37b347[_0x1d7da0(0xbe)]=_0x492526,_0x37b347;}var echarts__namespace=_interopNamespace(echarts),mars3d__namespace=_interopNamespace(mars3d);const Cesium$1=mars3d__namespace['Cesium'];class CompositeCoordinateSystem{constructor(_0x1bd4ad,_0x4235ee){const _0x5b849a={_0xf74ab3:0xb1},_0x48ad52=_0x4718;this['_mars3d_scene']=_0x1bd4ad,this['dimensions']=['lng','lat'],this[_0x48ad52(_0x5b849a._0xf74ab3)]=[0x0,0x0],this['_api']=_0x4235ee;}[_0x563c4e(0xb0)](_0xf1bfab){this['_mapOffset']=_0xf1bfab;}['getBMap'](){const _0x5094ae={_0x5afa96:0xd9},_0x372619=_0x563c4e;return this[_0x372619(_0x5094ae._0x5afa96)];}['dataToPoint'](_0x574c2e){const _0xe9e3fa={_0x3415d5:0xa1},_0x59aaed=_0x563c4e,_0x245010=this['_mars3d_scene'],_0x30c37e=[NaN,NaN];let _0x5fe7f5=_0x245010['echartsFixedHeight'];_0x245010[_0x59aaed(0xcb)]&&(_0x5fe7f5=_0x245010['globe']['getHeight'](Cesium$1['Cartographic']['fromDegrees'](_0x574c2e[0x0],_0x574c2e[0x1])));const _0x29ac62=Cesium$1['Cartesian3']['fromDegrees'](_0x574c2e[0x0],_0x574c2e[0x1],_0x5fe7f5);if(!_0x29ac62)return _0x30c37e;const _0x2f06fb=Cesium$1[_0x59aaed(_0xe9e3fa._0x3415d5)][_0x59aaed(0xae)](_0x245010,_0x29ac62);if(!_0x2f06fb)return _0x30c37e;if(_0x245010['echartsDepthTest']&&_0x245010['mode']===Cesium$1['SceneMode'][_0x59aaed(0xa9)]){const _0x3cbc58=new Cesium$1['EllipsoidalOccluder'](_0x245010['globe']['ellipsoid'],_0x245010['camera'][_0x59aaed(0xbd)]),_0x31eb6a=_0x3cbc58[_0x59aaed(0xa8)](_0x29ac62);if(!_0x31eb6a)return _0x30c37e;}return[_0x2f06fb['x']-this[_0x59aaed(0xb1)][0x0],_0x2f06fb['y']-this['_mapOffset'][0x1]];}[_0x563c4e(0xad)](){const _0x11c88d=this['_api'];return new echarts__namespace['graphic']['BoundingRect'](0x0,0x0,_0x11c88d['getWidth'](),_0x11c88d['getHeight']());}[_0x563c4e(0xdb)](){return echarts__namespace['matrix']['create']();}}CompositeCoordinateSystem['dimensions']=['lng','lat'],CompositeCoordinateSystem['create']=function(_0x5b8493,_0x52a888){const _0x36e08a={_0x30e850:0xb9},_0x2efab5=_0x563c4e;let _0x51420c;const _0x11d9a8=_0x5b8493[_0x2efab5(0xcc)]['ecInstance']['_mars3d_scene'];_0x5b8493['eachComponent'](_0x2efab5(0xa3),function(_0x1153ce){const _0x2be8ad=_0x2efab5,_0x4d3229=_0x52a888[_0x2be8ad(_0x36e08a._0x30e850)]()['painter'];if(!_0x4d3229)return;!_0x51420c&&(_0x51420c=new CompositeCoordinateSystem(_0x11d9a8,_0x52a888)),_0x1153ce['coordinateSystem']=_0x51420c,_0x51420c['setMapOffset'](_0x1153ce[_0x2be8ad(0xb8)]||[0x0,0x0]);}),_0x5b8493['eachSeries'](function(_0x23e97f){const _0x2c5510=_0x2efab5;_0x23e97f['get']('coordinateSystem')==='mars3dMap'&&(!_0x51420c&&(_0x51420c=new CompositeCoordinateSystem(_0x11d9a8,_0x52a888)),_0x23e97f[_0x2c5510(0xcd)]=_0x51420c);});};if(echarts__namespace!==null&&echarts__namespace!==void 0x0&&echarts__namespace['init'])echarts__namespace['registerCoordinateSystem']('mars3dMap',CompositeCoordinateSystem),echarts__namespace[_0x563c4e(0xd7)]({'type':'mars3dMapRoam','event':_0x563c4e(0xb5),'update':_0x563c4e(0xb3)},function(_0xd92330,_0x1d9273){}),echarts__namespace['extendComponentModel']({'type':'mars3dMap','getBMap':function(){return this['_mars3d_scene'];},'defaultOption':{'roam':![]}}),echarts__namespace[_0x563c4e(0xd6)]({'type':_0x563c4e(0xa3),'init':function(_0xfb3ec6,_0xbb47b6){const _0x35e742={_0x5d646d:0xd8},_0x2d8b18=_0x563c4e;this['api']=_0xbb47b6,this['scene']=_0xfb3ec6['scheduler']['ecInstance']['_mars3d_scene'],this['scene'][_0x2d8b18(_0x35e742._0x5d646d)]['addEventListener'](this['moveHandler'],this);},'moveHandler':function(_0x30dcc5,_0xda4241){const _0x40f553=_0x563c4e;this[_0x40f553(0xc3)]['dispatchAction']({'type':'mars3dMapRoam'});},'render':function(_0x4bfa94,_0x42dff9,_0x22c189){},'dispose':function(_0x1f4fb3){const _0x1b0d51={_0x34e954:0xc7},_0x579f79=_0x563c4e;this[_0x579f79(_0x1b0d51._0x34e954)]['postRender']['removeEventListener'](this['moveHandler'],this);}});else throw new Error('请引入\x20echarts\x20库\x20');const Cesium=mars3d__namespace[_0x563c4e(0xd5)],BaseLayer=mars3d__namespace[_0x563c4e(0xab)]['BaseLayer'];class EchartsLayer extends BaseLayer{constructor(_0xd3d0b4={}){super(_0xd3d0b4),this['_pointerEvents']=this['options']['pointerEvents'];}get[_0x563c4e(0xab)](){return this['_echartsInstance'];}get['pointerEvents'](){return this['_pointerEvents'];}set[_0x563c4e(0xa6)](_0x4fafc6){const _0x1fbcfb=_0x563c4e;this['_pointerEvents']=_0x4fafc6,this['_echartsContainer']&&(_0x4fafc6?this[_0x1fbcfb(0xd4)]['style']['pointerEvents']='all':this['_echartsContainer']['style']['pointerEvents']='none');}['_setOptionsHook'](_0x4217e0,_0xe4b4e6){const _0xa498fa={_0x5d333f:0xc0},_0x35cee0=_0x563c4e;this[_0x35cee0(_0xa498fa._0x5d333f)](_0x4217e0);}[_0x563c4e(0xaf)](_0x809fa4){const _0x2dffc0=_0x563c4e;_0x809fa4?this['_echartsContainer']['style']['visibility']='visible':this['_echartsContainer'][_0x2dffc0(0xac)]['visibility']='hidden';}['_mountedHook'](){const _0x517c37={_0x1a23aa:0xc2,_0x15294f:0xce,_0x10881a:0xc7},_0x2fe9de=_0x563c4e;this['_map']['scene']['echartsDepthTest']=this['options'][_0x2fe9de(_0x517c37._0x1a23aa)]??!![],this['_map']['scene']['echartsAutoHeight']=this[_0x2fe9de(_0x517c37._0x15294f)]['clampToGround']??![],this['_map'][_0x2fe9de(_0x517c37._0x10881a)]['echartsFixedHeight']=this['options']['fixedHeight']??0x0;}[_0x563c4e(0xbc)](){const _0xd3e1e4={_0x21f942:0xd2,_0xa2b434:0xc7,_0x3337eb:0xc0},_0x5ed4c7=_0x563c4e;this['_echartsContainer']=this['_createChartOverlay'](),this[_0x5ed4c7(0xd2)]=echarts__namespace[_0x5ed4c7(0xda)](this['_echartsContainer']),this[_0x5ed4c7(_0xd3e1e4._0x21f942)]['_mars3d_scene']=this[_0x5ed4c7(0xa2)][_0x5ed4c7(_0xd3e1e4._0xa2b434)],this[_0x5ed4c7(_0xd3e1e4._0x3337eb)](this['options']);}['_removedHook'](){const _0x2a73cc={_0x76115c:0xa2,_0x15d44e:0xd4},_0x30759d=_0x563c4e;this['_echartsInstance']&&(this['_echartsInstance']['clear'](),this['_echartsInstance']['dispose'](),delete this['_echartsInstance']),this[_0x30759d(0xd4)]&&(this[_0x30759d(_0x2a73cc._0x76115c)]['container']['removeChild'](this['_echartsContainer']),delete this[_0x30759d(_0x2a73cc._0x15d44e)]);}[_0x563c4e(0xc4)](){const _0x193423={_0x5181b2:0xc7,_0x3d2f1a:0xac,_0x33a7a2:0xce},_0x32f109=_0x563c4e,_0x1a3a5b=mars3d__namespace[_0x32f109(0xd0)]['create']('div',_0x32f109(0xdd),this['_map']['container']);return _0x1a3a5b['id']=this['id'],_0x1a3a5b['style']['position']='absolute',_0x1a3a5b['style']['top']='0px',_0x1a3a5b['style']['left']='0px',_0x1a3a5b[_0x32f109(0xac)]['width']=this['_map'][_0x32f109(_0x193423._0x5181b2)]['canvas']['clientWidth']+'px',_0x1a3a5b['style']['height']=this['_map'][_0x32f109(0xc7)]['canvas']['clientHeight']+'px',_0x1a3a5b[_0x32f109(0xac)]['pointerEvents']=this['_pointerEvents']?'all':'none',_0x1a3a5b[_0x32f109(_0x193423._0x3d2f1a)]['zIndex']=this[_0x32f109(_0x193423._0x33a7a2)]['zIndex']??0x9,_0x1a3a5b;}['resize'](){const _0x44e6ea={_0x1e7d0c:0xa4,_0xf8d268:0xa0},_0x3271a5=_0x563c4e;if(!this[_0x3271a5(0xd2)])return;this['_echartsContainer'][_0x3271a5(0xac)][_0x3271a5(_0x44e6ea._0x1e7d0c)]=this['_map']['scene'][_0x3271a5(_0x44e6ea._0xf8d268)]['clientWidth']+'px',this[_0x3271a5(0xd4)]['style']['height']=this['_map']['scene']['canvas']['clientHeight']+'px',this['_echartsInstance']['resize']();}['setEchartsOption'](_0x160ee4,_0x40e1a1,_0x1a0412){const _0x4430ee={_0xc6bed6:0xd2},_0x75f0ed=_0x563c4e;this[_0x75f0ed(_0x4430ee._0xc6bed6)]&&(_0x160ee4={'mars3dMap':{},...mars3d__namespace['Util']['getAttrVal'](_0x160ee4,{'onlySimpleType':!![]})},delete _0x160ee4['eventParent'],this['_echartsInstance']['setOption'](_0x160ee4,_0x40e1a1,_0x1a0412));}['getRectangle'](_0x5a5f57){const _0x19a2fb={_0x492baa:0xb6},_0xb145cc={_0x2af5e9:0xc8},_0x43777d=_0x563c4e;let _0x2640b0,_0x2bf04d,_0x18563e,_0x1df1a0;function _0x30e791(_0x3a46f6){const _0x1392ca=_0x4718;if(!Array['isArray'](_0x3a46f6))return;const _0x195254=_0x3a46f6[0x0]||0x0,_0x1d5685=_0x3a46f6[0x1]||0x0;_0x195254!==0x0&&_0x1d5685!==0x0&&(_0x2640b0===undefined?(_0x2640b0=_0x195254,_0x2bf04d=_0x195254,_0x18563e=_0x1d5685,_0x1df1a0=_0x1d5685):(_0x2640b0=Math['min'](_0x2640b0,_0x195254),_0x2bf04d=Math['max'](_0x2bf04d,_0x195254),_0x18563e=Math['min'](_0x18563e,_0x1d5685),_0x1df1a0=Math[_0x1392ca(_0xb145cc._0x2af5e9)](_0x1df1a0,_0x1d5685)));}const _0x3e13e7=this[_0x43777d(0xce)]['series'];_0x3e13e7&&_0x3e13e7[_0x43777d(_0x19a2fb._0x492baa)](_0x1c890c=>{_0x1c890c['data']&&_0x1c890c['data']['forEach'](_0x3f2a67=>{const _0x47eeff=_0x4718;if(_0x3f2a67[_0x47eeff(0xd1)])_0x30e791(_0x3f2a67['value']);else _0x3f2a67['coords']&&_0x3f2a67[_0x47eeff(0xd3)]['forEach'](_0x4db491=>{_0x30e791(_0x4db491);});});});if(_0x2640b0===0x0&&_0x18563e===0x0&&_0x2bf04d===0x0&&_0x1df1a0===0x0)return null;return _0x5a5f57!==null&&_0x5a5f57!==void 0x0&&_0x5a5f57['isFormat']?{'xmin':_0x2640b0,'xmax':_0x2bf04d,'ymin':_0x18563e,'ymax':_0x1df1a0}:Cesium[_0x43777d(0xc5)]['fromDegrees'](_0x2640b0,_0x18563e,_0x2bf04d,_0x1df1a0);}['on'](_0x19599e,_0x59de95,_0x44b187){const _0x1c55da=_0x563c4e;return this[_0x1c55da(0xd2)]['on'](_0x19599e,_0x59de95,_0x44b187||this),this;}[_0x563c4e(0x9f)](_0x63e731,_0x4456fd,_0x15b9dd,_0x22009f){return this['_echartsInstance']['on'](_0x63e731,_0x4456fd,_0x15b9dd,_0x22009f||this),this;}[_0x563c4e(0xa7)](_0x1e9ab6,_0x180cac,_0x1e8857){return this['_echartsInstance']['off'](_0x1e9ab6,_0x180cac,_0x1e8857||this),this;}}mars3d__namespace['LayerUtil']['register'](_0x563c4e(0xb4),EchartsLayer),mars3d__namespace['layer']['EchartsLayer']=EchartsLayer,mars3d__namespace[_0x563c4e(0xb4)]=echarts__namespace,exports[_0x563c4e(0xc9)]=EchartsLayer,Object['keys'](echarts)[_0x563c4e(0xb6)](function(_0x550b25){const _0x3b4918={_0x29a28b:0xbe,_0x4aaed5:0xb2},_0xb4a835=_0x563c4e;if(_0x550b25!==_0xb4a835(_0x3b4918._0x29a28b)&&!exports[_0xb4a835(_0x3b4918._0x4aaed5)](_0x550b25))Object['defineProperty'](exports,_0x550b25,{'enumerable':!![],'get':function(){return echarts[_0x550b25];}});}),Object[_0x563c4e(0xba)](exports,'__esModule',{'value':!![]});function _0x4146(){const _0x14a1ba=['extendComponentView','registerAction','postRender','_mars3d_scene','init','getRoamTransform','1772ICelFT','mars3d-echarts','1752772CjpvOE','onByQuery','canvas','SceneTransforms','_map','mars3dMap','width','3765MlTCpV','pointerEvents','off','isPointVisible','SCENE3D','8595441oHaIqA','layer','style','getViewRect','wgs84ToWindowCoordinates','_showHook','setMapOffset','_mapOffset','hasOwnProperty','updateLayout','echarts','mars3dMapRoam','forEach','35233OEkwNW','__mapOffset','getZr','defineProperty','767111jqtjKR','_addedHook','positionWC','default','4130vprHiy','setEchartsOption','650IwzJoi','depthTest','api','_createChartOverlay','Rectangle','16056pQWbaF','scene','max','EchartsLayer','24LojFmM','echartsAutoHeight','scheduler','coordinateSystem','options','203LjnLXL','DomUtil','value','_echartsInstance','coords','_echartsContainer','Cesium'];_0x4146=function(){return _0x14a1ba;};return _0x4146();}
}));

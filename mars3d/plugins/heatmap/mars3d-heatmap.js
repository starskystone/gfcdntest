/**
 * Mars3D平台插件,结合heatmap可视化功能插件  mars3d-heatmap
 *
 * 版本信息：v3.6.18
 * 编译日期：2023-12-31 22:41:58
 * 版权所有：Copyright by 火星科技  http://mars3d.cn
 * 使用单位：免费公开版 ，2023-03-17
 */
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, (window.mars3d || require('mars3d')), (window.h337 || require('@mars3d/heatmap.js'))) :
  typeof define === 'function' && define.amd ? define(['exports', 'mars3d', '@mars3d/heatmap.js'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global["mars3d-heatmap"] = {}, global.mars3d, global.h337));
})(this, (function (exports, mars3d, h337) { 
'use strict';const _0x4f1353=_0x2c04;(function(_0x507e68,_0x1305f9){const _0x53ffa4={_0x346346:0x19a},_0x3318d3=_0x2c04,_0x306284=_0x507e68();while(!![]){try{const _0x2f8c16=-parseInt(_0x3318d3(0x17e))/0x1*(parseInt(_0x3318d3(0x16d))/0x2)+parseInt(_0x3318d3(0x18a))/0x3*(-parseInt(_0x3318d3(0x18d))/0x4)+-parseInt(_0x3318d3(0x177))/0x5+-parseInt(_0x3318d3(0x173))/0x6+-parseInt(_0x3318d3(0x19f))/0x7+-parseInt(_0x3318d3(0x161))/0x8+parseInt(_0x3318d3(_0x53ffa4._0x346346))/0x9;if(_0x2f8c16===_0x1305f9)break;else _0x306284['push'](_0x306284['shift']());}catch(_0x3d45f5){_0x306284['push'](_0x306284['shift']());}}}(_0x22e0,0x2b8f7));function _0x2c04(_0x1ff9de,_0x236804){const _0x22e087=_0x22e0();return _0x2c04=function(_0x2c0421,_0x15eff5){_0x2c0421=_0x2c0421-0x159;let _0x4f27ea=_0x22e087[_0x2c0421];return _0x4f27ea;},_0x2c04(_0x1ff9de,_0x236804);}function _interopNamespace(_0x4748b6){const _0x13602f={_0x25fc32:0x18f},_0x36e77e={_0x28f78a:0x15f},_0x1873b4=_0x2c04;if(_0x4748b6&&_0x4748b6['__esModule'])return _0x4748b6;var _0xa7dea9=Object[_0x1873b4(0x194)](null);return _0x4748b6&&Object[_0x1873b4(_0x13602f._0x25fc32)](_0x4748b6)['forEach'](function(_0x344c41){const _0x2f190b=_0x1873b4;if(_0x344c41!==_0x2f190b(_0x36e77e._0x28f78a)){var _0x486e9d=Object['getOwnPropertyDescriptor'](_0x4748b6,_0x344c41);Object['defineProperty'](_0xa7dea9,_0x344c41,_0x486e9d[_0x2f190b(0x169)]?_0x486e9d:{'enumerable':!![],'get':function(){return _0x4748b6[_0x344c41];}});}}),_0xa7dea9['default']=_0x4748b6,_0xa7dea9;}var mars3d__namespace=_interopNamespace(mars3d),h337__namespace=_interopNamespace(h337),HeatMaterial='uniform\x20sampler2D\x20image;\x0a\x0aczm_material\x20czm_getMaterial(czm_materialInput\x20materialInput)\x20{\x0a\x20\x20czm_material\x20material\x20=\x20czm_getDefaultMaterial(materialInput);\x0a\x20\x20vec2\x20st\x20=\x20materialInput.st;\x0a\x20\x20vec4\x20colorImage\x20=\x20texture(image,\x20st);\x0a\x20\x20if(colorImage.rgb\x20==\x20vec3(1.0)\x20||\x20colorImage.rgb\x20==\x20vec3(0.0))\x20{\x0a\x20\x20\x20\x20discard;\x0a\x20\x20}\x0a\x20\x20material.diffuse\x20=\x20colorImage.rgb;\x0a\x20\x20material.alpha\x20=\x20colorImage.a;\x0a\x20\x20return\x20material;\x0a}\x0a';if(!h337__namespace['create'])throw new Error('请引入\x20heatmap.js\x20库\x20');const Cesium=mars3d__namespace['Cesium'],BaseLayer=mars3d__namespace[_0x4f1353(0x17c)]['BaseLayer'],DEF_HEATSTYLE={'maxOpacity':0.8,'minOpacity':0.1,'blur':0.85,'radius':0x19,'gradient':{0.4:_0x4f1353(0x182),0.6:'green',0.8:_0x4f1353(0x15d),0.9:'red'}},DEF_STYLE={'arcRadiusScale':1.5,'arcBlurScale':1.5,'vertexFormat':Cesium['EllipsoidSurfaceAppearance'][_0x4f1353(0x1ae)]};class HeatLayer extends BaseLayer{constructor(_0x5473f6={}){const _0x17b378={_0xa5c539:0x15a,_0x4b628f:0x197,_0x4c878e:0x1a3,_0x4d7c9c:0x1a3,_0x419c4f:0x15c},_0x212abe=_0x4f1353;super(_0x5473f6),this['options'][_0x212abe(_0x17b378._0xa5c539)]=this[_0x212abe(0x1a3)]['maxCanvasSize']??document[_0x212abe(0x190)]['clientWidth'],this['options'][_0x212abe(_0x17b378._0xa5c539)]=Math[_0x212abe(_0x17b378._0x4b628f)](this['options']['maxCanvasSize'],0x1388),this[_0x212abe(_0x17b378._0x4c878e)]['minCanvasSize']=this[_0x212abe(_0x17b378._0x4d7c9c)][_0x212abe(_0x17b378._0x419c4f)]??document['body']['clientHeight'],this['options'][_0x212abe(0x15c)]=Math['max'](this[_0x212abe(0x1a3)]['minCanvasSize'],0x2bc),this[_0x212abe(0x1a3)]['heatStyle']={...DEF_HEATSTYLE,...this['options']['heatStyle']},this['options']['style']={...DEF_STYLE,...this['options']['style']};}get['layer'](){return this['_layer'];}get['heatStyle'](){return this['options']['heatStyle'];}set['heatStyle'](_0x4cd87c){const _0x2b6744={_0x3456d9:0x1ab,_0x5115ad:0x1b1},_0x7f5db9=_0x4f1353;this['options']['heatStyle']=mars3d__namespace['Util']['merge'](this['options']['heatStyle'],_0x4cd87c),this[_0x7f5db9(_0x2b6744._0x3456d9)]&&(this['_heat']['configure'](this['options'][_0x7f5db9(_0x2b6744._0x5115ad)]),this['_updatePositionsHook'](!![]));}get['style'](){return this['options']['style'];}set['style'](_0x279e90){this['options']['style']=mars3d__namespace['Util']['merge'](this['options']['style'],_0x279e90);}get[_0x4f1353(0x181)](){return this['_positions'];}set['positions'](_0x3d8c47){const _0x524a7d=_0x4f1353;this[_0x524a7d(0x162)](_0x3d8c47);}get[_0x4f1353(0x1ad)](){const _0x2baa5b=[];return this['points']['forEach'](_0x429131=>{const _0x498e11=_0x2c04;_0x2baa5b[_0x498e11(0x1a7)](_0x429131['toArray']());}),_0x2baa5b;}get['rectangle'](){return this['_rectangle'];}['_setOptionsHook'](_0x588fee,_0x3730bf){const _0x4581fd={_0x84ce7e:0x181},_0x40df12=_0x4f1353;_0x588fee[_0x40df12(_0x4581fd._0x84ce7e)]&&(this['positions']=_0x588fee['positions']);}[_0x4f1353(0x16b)](){const _0x4f8079={_0x32774d:0x17c},_0x4f44b4=_0x4f1353;this['style']['type']==='image'?this['_layer']=new mars3d__namespace[(_0x4f44b4(_0x4f8079._0x32774d))][(_0x4f44b4(0x18e))]({'crs':_0x4f44b4(0x16a),'private':!![]}):this['_layer']=new mars3d__namespace['layer']['GraphicLayer']({'private':!![]});}['_addedHook'](){const _0xc5f5e6={_0x413a9e:0x184,_0x3607db:0x1a3},_0x3f78f1=_0x4f1353;this['_map']['addLayer'](this['_layer']),this['_container']=mars3d__namespace[_0x3f78f1(0x1a9)]['create']('div','mars3d-heatmap\x20mars3d-hideDiv',this[_0x3f78f1(_0xc5f5e6._0x413a9e)]['container']),this['options']['positions']&&(this['positions']=this[_0x3f78f1(0x1a3)][_0x3f78f1(0x181)]),this[_0x3f78f1(_0xc5f5e6._0x3607db)][_0x3f78f1(0x186)]&&this['flyToByAnimationEnd']();}['_removedHook'](){const _0x4d745a={_0x5bca44:0x19c},_0x89fd7e=_0x4f1353;this[_0x89fd7e(_0x4d745a._0x5bca44)]&&(mars3d__namespace['DomUtil']['remove'](this['_container']),delete this['_container']),this['clear'](),this['_map']['removeLayer'](this['_layer']);}['addPosition'](_0x5bd509,_0x44ac3a){const _0x16b71f=_0x4f1353;this[_0x16b71f(0x15b)]=this['_positions']||[],this['_positions']['push'](_0x5bd509),this['_updatePositionsHook'](_0x44ac3a);}[_0x4f1353(0x162)](_0x49f716,_0x2f492e){const _0x354058=_0x4f1353;this[_0x354058(0x15b)]=_0x49f716,this['_updatePositionsHook'](_0x2f492e);}['clear'](){const _0x407eed={_0xd860a5:0x163,_0x2224de:0x193},_0xf1a867=_0x4f1353;this[_0xf1a867(0x176)]&&(this[_0xf1a867(_0x407eed._0xd860a5)][_0xf1a867(_0x407eed._0x2224de)](this['_graphic'],!![]),delete this['_graphic']),this['_graphic2']&&(this['_layer']['removeGraphic'](this['_graphic2'],!![]),delete this['_graphic2']);}[_0x4f1353(0x17a)](_0x5a65e8){const _0x4e45a4={_0x351ecf:0x17f,_0x51e448:0x176,_0x50513a:0x167,_0x2ba67c:0x19b,_0x33fd8e:0x198},_0x4b7ea1=_0x4f1353;if(!this['show']||!this['_map']||!this['positions']||this['positions']['length']===0x0)return this;const _0x3be9e7=this['_getHeatCanvas']();if(this['style']['type']===_0x4b7ea1(0x198))this['_layer']['setOptions']({'url':_0x3be9e7['toDataURL']('image/png',0x1),'rectangle':this['_rectangle'],'opacity':this['style']['opacity']});else this['style'][_0x4b7ea1(_0x4e45a4._0x351ecf)]?this['_graphic']&&_0x5a65e8?(this[_0x4b7ea1(_0x4e45a4._0x51e448)]['uniforms']['image']=_0x3be9e7,this['_graphic']['uniforms']['bumpMap']=this['_getArcHeatCanvas'](),this['_graphic2']&&(this['_graphic2']['uniforms']['image']=_0x3be9e7,this['_graphic2'][_0x4b7ea1(_0x4e45a4._0x50513a)]['bumpMap']=this[_0x4b7ea1(0x176)]['uniforms']['bumpMap'])):this[_0x4b7ea1(_0x4e45a4._0x2ba67c)](_0x3be9e7):this['_graphic']&&_0x5a65e8?this[_0x4b7ea1(0x176)]['uniforms'][_0x4b7ea1(_0x4e45a4._0x33fd8e)]=_0x3be9e7:this['_createGraphic'](_0x3be9e7);return this;}['_createGraphic'](_0x21df74){const _0xaab9f7={_0x49fcaa:0x174,_0x5cc5fd:0x16e},_0x4cbdaa=_0x4f1353;this[_0x4cbdaa(_0xaab9f7._0x49fcaa)](),this[_0x4cbdaa(0x176)]=new mars3d__namespace['graphic']['RectanglePrimitive']({...this['options'],'rectangle':this[_0x4cbdaa(_0xaab9f7._0x5cc5fd)],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'material':new Cesium['Material']({'fabric':{'uniforms':{'image':_0x21df74},'source':HeatMaterial},'translucent':!![]}),'flat':!![]})}),this['_layer']['addGraphic'](this['_graphic']);}['_createArcGraphic'](_0x1aee83){const _0x258c0={_0x315077:0x1a5,_0x5c8be9:0x199,_0x48e49a:0x165,_0x313850:0x171,_0x6ff654:0x178,_0x2ce8c3:0x1b3,_0xeade31:0x187,_0x4818ab:0x179,_0x2942bf:0x179,_0x320199:0x1a3,_0x24ee14:0x163},_0xd04323=_0x4f1353;this[_0xd04323(0x174)]();const _0x37fd2f=Cesium['RenderState']['fromCache']({'cull':{'enabled':!![]},'depthTest':{'enabled':!![]},'stencilTest':{'enabled':!![],'frontFunction':Cesium['StencilFunction']['ALWAYS'],'frontOperation':{'fail':Cesium['StencilOperation']['KEEP'],'zFail':Cesium[_0xd04323(0x195)]['KEEP'],'zPass':Cesium[_0xd04323(0x195)][_0xd04323(0x1aa)]},'backFunction':Cesium[_0xd04323(_0x258c0._0x315077)][_0xd04323(_0x258c0._0x5c8be9)],'backOperation':{'fail':Cesium['StencilOperation'][_0xd04323(0x183)],'zFail':Cesium['StencilOperation']['KEEP'],'zPass':Cesium['StencilOperation']['REPLACE']},'reference':0x2,'mask':0x2},'blending':Cesium['BlendingState']['ALPHA_BLEND']}),_0x185bda=Math['floor'](this[_0xd04323(_0x258c0._0x48e49a)][_0xd04323(_0x258c0._0x313850)]??this['_mBoundsMax']*0.02)+0.1;this[_0xd04323(0x165)][_0xd04323(0x171)]&&delete this['style']['diffHeight'];const _0x8ae164=(this[_0xd04323(0x165)][_0xd04323(0x19d)],0x64);let _0x527273=Math[_0xd04323(0x16c)](this['_rectangle']['height'],this[_0xd04323(0x16e)]['width']);this['style']['granularity']=_0x527273/=_0x8ae164;const _0x2c12b2=new Cesium[(_0xd04323(_0x258c0._0x6ff654))]({'fabric':{'uniforms':{'image':_0x1aee83,'repeat':new Cesium['Cartesian2'](0x1,0x1),'color':new Cesium[(_0xd04323(_0x258c0._0x2ce8c3))](0x1,0x1,0x1,0x0),'bumpMap':this['_getArcHeatCanvas']()},'source':HeatMaterial},'translucent':!![]}),_0x441003=this['style'][_0xd04323(_0x258c0._0xeade31)]||0x1;this[_0xd04323(0x176)]=new mars3d__namespace[(_0xd04323(0x185))][(_0xd04323(_0x258c0._0x4818ab))]({...this['options'],'rectangle':this['_rectangle'],'appearance':new Cesium[(_0xd04323(0x191))]({'flat':!![],'aboveGround':!![],'renderState':_0x37fd2f,'material':_0x2c12b2,'vertexShaderSource':getVertexShaderSource(_0x185bda*_0x441003)})}),this[_0xd04323(0x163)]['addGraphic'](this['_graphic']),this['style']['arcDirection']===0x0&&(this['_graphic2']=new mars3d__namespace['graphic'][(_0xd04323(_0x258c0._0x2942bf))]({...this[_0xd04323(_0x258c0._0x320199)],'rectangle':this['_rectangle'],'appearance':new Cesium['EllipsoidSurfaceAppearance']({'flat':!![],'aboveGround':!![],'renderState':_0x37fd2f,'material':_0x2c12b2,'vertexShaderSource':getVertexShaderSource(-_0x185bda)})}),this[_0xd04323(_0x258c0._0x24ee14)]['addGraphic'](this[_0xd04323(0x1a6)]));}['getRectangle'](_0x375f31){const _0x4e2bc7={_0xa0181a:0x18b},_0x46814e=_0x4f1353;return _0x375f31!==null&&_0x375f31!==void 0x0&&_0x375f31['isFormat']&&this['_rectangle']?mars3d__namespace[_0x46814e(0x1ac)][_0x46814e(_0x4e2bc7._0xa0181a)](this['_rectangle']):this['_rectangle'];}['_getHeatCanvas'](){const _0x37967a={_0x1643a5:0x1a3,_0x316c34:0x196,_0x389ae8:0x192,_0x305be0:0x15a,_0x40447c:0x15c,_0x459bc5:0x1a3,_0x42de8b:0x15a,_0x221e29:0x16e,_0x3fc7f7:0x1a4,_0x13d7bb:0x1af,_0x469241:0x16c,_0x175407:0x16f,_0x59b7fc:0x1a2,_0x2fcdff:0x188,_0x5084d7:0x1b1,_0x5c32a2:0x19c},_0x41356d={_0x4b902a:0x164,_0x3663fe:0x1a7},_0x2c128f={_0x486718:0x1af,_0x5a9679:0x1a3,_0x467b00:0x17d,_0x312ddb:0x16c},_0x4716a8=_0x4f1353,_0x3e71e6=this['_positions'],_0x575968=[];let _0x1af6a5,_0xbce000,_0x314a76,_0x476c59;_0x3e71e6['forEach'](_0x1b3c7f=>{const _0x5a65c0=_0x2c04,_0x15712=mars3d__namespace['LngLatPoint'][_0x5a65c0(0x1a8)](_0x1b3c7f);if(!_0x15712)return;_0x15712['value']=_0x1b3c7f[_0x5a65c0(_0x2c128f._0x486718)]||0x1,!this[_0x5a65c0(_0x2c128f._0x5a9679)]['rectangle']&&(_0x1af6a5===undefined?(_0x1af6a5=_0x15712['lng'],_0xbce000=_0x15712['lng'],_0x314a76=_0x15712['lat'],_0x476c59=_0x15712[_0x5a65c0(_0x2c128f._0x467b00)]):(_0x1af6a5=Math[_0x5a65c0(0x197)](_0x1af6a5,_0x15712['lng']),_0xbce000=Math['max'](_0xbce000,_0x15712['lng']),_0x314a76=Math['min'](_0x314a76,_0x15712[_0x5a65c0(_0x2c128f._0x467b00)]),_0x476c59=Math[_0x5a65c0(_0x2c128f._0x312ddb)](_0x476c59,_0x15712[_0x5a65c0(0x17d)]))),_0x575968['push'](_0x15712);});_0x1af6a5===_0xbce000&&(_0x1af6a5-=0.000001,_0xbce000+=0.000001);_0x314a76===_0x476c59&&(_0x314a76-=0.000001,_0x476c59+=0.000001);let _0x4455e3=this[_0x4716a8(_0x37967a._0x1643a5)][_0x4716a8(_0x37967a._0x316c34)]||{'xmin':_0x1af6a5,'xmax':_0xbce000,'ymin':_0x314a76,'ymax':_0x476c59};const _0x465121=getMercatorBounds(_0x4455e3),_0x1562a3=Math['abs'](_0x465121[_0x4716a8(_0x37967a._0x389ae8)]-_0x465121['xmin']),_0x2c7f75=Math['abs'](_0x465121['ymax']-_0x465121[_0x4716a8(0x1a4)]),_0x3e4bdf=Math['max'](_0x1562a3,_0x2c7f75),_0x20736f=Math['min'](_0x1562a3,_0x2c7f75);this['_mBoundsMax']=_0x3e4bdf;let _0x12c55d=0x1;if(_0x3e4bdf>this['options'][_0x4716a8(_0x37967a._0x305be0)])_0x12c55d=_0x3e4bdf/this['options']['maxCanvasSize'],_0x20736f/_0x12c55d<this['options'][_0x4716a8(_0x37967a._0x40447c)]&&(_0x12c55d=_0x20736f/this['options']['minCanvasSize']);else _0x20736f<this['options']['minCanvasSize']&&(_0x12c55d=_0x20736f/this[_0x4716a8(0x1a3)]['minCanvasSize'],_0x3e4bdf/_0x12c55d>this[_0x4716a8(_0x37967a._0x459bc5)]['maxCanvasSize']&&(_0x12c55d=_0x3e4bdf/this['options'][_0x4716a8(_0x37967a._0x42de8b)]));const _0x42b138=this['heatStyle'][_0x4716a8(0x17b)]*1.5,_0x21caa1=_0x1562a3/_0x12c55d+_0x42b138*0x2,_0x283f03=_0x2c7f75/_0x12c55d+_0x42b138*0x2,_0x56ea5c=_0x42b138*_0x12c55d;_0x465121['xmin']-=_0x56ea5c,_0x465121['ymin']-=_0x56ea5c,_0x465121['xmax']+=_0x56ea5c,_0x465121[_0x4716a8(0x168)]+=_0x56ea5c,this['_scale']=_0x12c55d,_0x4455e3=geLatLngBounds(_0x465121),this[_0x4716a8(_0x37967a._0x221e29)]=Cesium['Rectangle']['fromDegrees'](_0x4455e3['xmin'],_0x4455e3[_0x4716a8(_0x37967a._0x3fc7f7)],_0x4455e3['xmax'],_0x4455e3['ymax']);let _0x2f8c7b=_0x575968[0x0][_0x4716a8(0x1af)]??0x1,_0x4893dd=_0x575968[0x0][_0x4716a8(_0x37967a._0x13d7bb)]??0x0;const _0x22cd9e=[];_0x575968['forEach'](_0x1c960c=>{const _0x34db13=_0x4716a8,_0x3e51c8=mars3d__namespace['PointTrans'][_0x34db13(_0x41356d._0x4b902a)]([_0x1c960c['lng'],_0x1c960c[_0x34db13(0x17d)]]),_0x13e244=_0x1c960c['value']||0x1,_0x2caafb=Math['round']((_0x3e51c8[0x0]-_0x465121['xmin'])/_0x12c55d),_0x4bd047=Math['round']((_0x465121['ymax']-_0x3e51c8[0x1])/_0x12c55d);_0x2f8c7b=Math['max'](_0x2f8c7b,_0x13e244),_0x4893dd=Math['min'](_0x4893dd,_0x13e244),_0x22cd9e[_0x34db13(_0x41356d._0x3663fe)]({'x':_0x2caafb,'y':_0x4bd047,'value':_0x13e244});});const _0x231ad8={'min':this['options'][_0x4716a8(0x197)]??_0x4893dd,'max':this[_0x4716a8(_0x37967a._0x1643a5)][_0x4716a8(_0x37967a._0x469241)]??_0x2f8c7b,'data':_0x22cd9e};this[_0x4716a8(0x189)]=_0x231ad8;if(!this['_last_mBounds']||_0x465121['xmin']!==this[_0x4716a8(_0x37967a._0x175407)]['xmin']||_0x465121[_0x4716a8(0x1a4)]!==this['_last_mBounds']['ymin']||_0x465121['xmax']!==this['_last_mBounds']['xmax']||_0x465121['ymax']!==this['_last_mBounds']['ymax']){this[_0x4716a8(0x16f)]=_0x465121,this['_container'][_0x4716a8(0x165)][_0x4716a8(_0x37967a._0x59b7fc)]=_0x4716a8(_0x37967a._0x2fcdff)+_0x21caa1+'px;height:'+_0x283f03+'px;';const _0x844ca1={...this[_0x4716a8(_0x37967a._0x5084d7)],'container':this[_0x4716a8(_0x37967a._0x5c32a2)]};!this[_0x4716a8(0x1ab)]?this['_heat']=h337__namespace['create'](_0x844ca1):this[_0x4716a8(0x1ab)]['configure'](_0x844ca1);}this['_heat']['setData'](_0x231ad8);const _0x1e95c5=mars3d__namespace[_0x4716a8(0x1a9)][_0x4716a8(0x175)](this['_heat']['_renderer']['canvas']);return _0x1e95c5;}['_getArcHeatCanvas'](){const _0x2996d9={_0x2e666c:0x180},_0x5d0117=_0x4f1353;this['_heat'][_0x5d0117(0x18c)]({'radius':this['heatStyle']['radius']*this['style'][_0x5d0117(_0x2996d9._0x2e666c)],'blur':this[_0x5d0117(0x1b1)]['blur']*this['style'][_0x5d0117(0x1a1)],'gradient':this['heatStyle'][_0x5d0117(0x15e)]||{0.25:'rgb(0,0,0)',0.55:_0x5d0117(0x172),0.85:'rgb(216,216,216)',0x1:'rgb(255,255,255)'}});const _0x3215a5=mars3d__namespace[_0x5d0117(0x1a9)]['copyCanvas'](this['_heat']['_renderer']['canvas']);return this['_heat']['configure'](this[_0x5d0117(0x1a3)]['heatStyle']),_0x3215a5;}['getPointData'](_0x5a6a92){const _0x351ac8={_0x1ccfba:0x164,_0x492ab1:0x166},_0x393f04=_0x4f1353,_0x26ddff=mars3d__namespace['LngLatPoint']['parse'](_0x5a6a92);if(!_0x26ddff)return{};const _0xc955ed=mars3d__namespace['PointTrans'][_0x393f04(_0x351ac8._0x1ccfba)]([_0x26ddff['lng'],_0x26ddff['lat']]),_0x575893=this[_0x393f04(0x16f)],_0x3a7d5d=Math['round']((_0xc955ed[0x0]-_0x575893['xmin'])/this['_scale']),_0xc12086=Math['round']((_0x575893['ymax']-_0xc955ed[0x1])/this['_scale']),_0x29e484=this[_0x393f04(0x1ab)][_0x393f04(_0x351ac8._0x492ab1)]({'x':_0x3a7d5d,'y':_0xc12086}),_0x49b158=this['_heat']['_renderer']['ctx']['getImageData'](_0x3a7d5d-0x1,_0xc12086-0x1,0x1,0x1)['data'];return{'x':_0x3a7d5d,'y':_0xc12086,'value':_0x29e484,'color':'rgba('+_0x49b158[0x0]+','+_0x49b158[0x1]+','+_0x49b158[0x2]+','+_0x49b158[0x3]+')'};}}mars3d__namespace['LayerUtil'][_0x4f1353(0x19e)](_0x4f1353(0x160),HeatLayer),mars3d__namespace[_0x4f1353(0x17c)]['HeatLayer']=HeatLayer,mars3d__namespace[_0x4f1353(0x170)]=h337__namespace;function _0x22e0(){const _0x13c81c=['minCanvasSize','yellow','gradientArc','default','heat','2718344wHQogV','setPositions','_layer','lonlat2mercator','style','getValueAt','uniforms','ymax','get','EPSG:3857','_mountedHook','max','56tUwKrW','_rectangle','_last_mBounds','h337','diffHeight','rgb(140,140,140)','202440TKDrCx','clear','copyCanvas','_graphic','578605JeCpEK','Material','RectanglePrimitive','_updatePositionsHook','radius','layer','lat','12046gumyQC','arc','arcRadiusScale','positions','blue','KEEP','_map','graphic','flyTo','arcDirection','width:','_last_heatData','402819FGiknL','formatRectangle','configure','8chnbub','ImageLayer','keys','body','EllipsoidSurfaceAppearance','xmax','removeGraphic','create','StencilOperation','rectangle','min','image','ALWAYS','13169331hCSSZB','_createArcGraphic','_container','splitNum','register','1328236OtLAna','PointTrans','arcBlurScale','cssText','options','ymin','StencilFunction','_graphic2','push','parse','DomUtil','REPLACE','_heat','PolyUtil','coordinates','VERTEX_FORMAT','value',';\x0a\x20\x20\x20\x20p\x20+=vec4(disPos,0.0);\x0a\x20\x20\x20\x20gl_Position\x20=\x20czm_modelViewProjectionRelativeToEye\x20*\x20p;\x0a\x20\x20}\x0a','heatStyle','mercator2lonlat','Color','__esModule','maxCanvasSize','_positions'];_0x22e0=function(){return _0x13c81c;};return _0x22e0();}function getMercatorBounds(_0xadd399){const _0x1ddc18=_0x4f1353,_0xc44955=mars3d__namespace['PointTrans']['lonlat2mercator']([_0xadd399['xmin'],_0xadd399[_0x1ddc18(0x1a4)]]),_0xa67107=mars3d__namespace['PointTrans']['lonlat2mercator']([_0xadd399['xmax'],_0xadd399['ymax']]);return{'xmin':_0xc44955[0x0],'ymin':_0xc44955[0x1],'xmax':_0xa67107[0x0],'ymax':_0xa67107[0x1]};}function geLatLngBounds(_0x2ed5ec){const _0x1372dc={_0x4e3888:0x1b2,_0x4a9821:0x192},_0x25ca4b=_0x4f1353,_0x1e0c4a=mars3d__namespace[_0x25ca4b(0x1a0)][_0x25ca4b(_0x1372dc._0x4e3888)]([_0x2ed5ec['xmin'],_0x2ed5ec['ymin']]),_0x5a8765=mars3d__namespace['PointTrans']['mercator2lonlat']([_0x2ed5ec[_0x25ca4b(_0x1372dc._0x4a9821)],_0x2ed5ec['ymax']]);return{'xmin':_0x1e0c4a[0x0],'ymin':_0x1e0c4a[0x1],'xmax':_0x5a8765[0x0],'ymax':_0x5a8765[0x1]};}function getVertexShaderSource(_0x41570f){const _0x2b8083={_0x3f58a6:0x1b0},_0x3daa63=_0x4f1353;return'in\x20vec3\x20position3DHigh;\x0a\x20\x20in\x20vec3\x20position3DLow;\x0a\x20\x20in\x20vec2\x20st;\x0a\x20\x20in\x20float\x20batchId;\x0a\x20\x20uniform\x20sampler2D\x20bumpMap_3;\x0a\x20\x20out\x20vec3\x20v_positionMC;\x0a\x20\x20out\x20vec3\x20v_positionEC;\x0a\x20\x20out\x20vec2\x20v_st;\x0a\x0a\x20\x20void\x20main()\x0a\x20\x20{\x0a\x20\x20\x20\x20vec4\x20p\x20=\x20czm_computePosition();\x0a\x20\x20\x20\x20v_positionMC\x20=\x20position3DHigh\x20+\x20position3DLow;\x0a\x20\x20\x20\x20v_positionEC\x20=\x20(czm_modelViewRelativeToEye\x20*\x20p).xyz;\x0a\x20\x20\x20\x20v_st\x20=\x20st;\x0a\x20\x20\x20\x20vec4\x20color\x20=\x20texture(bumpMap_3,\x20v_st);\x0a\x20\x20\x20\x20float\x20centerBump\x20=\x20distance(vec3(0.0),color.rgb);\x0a\x20\x20\x20\x20vec3\x20upDir\x20=\x20normalize(v_positionMC.xyz);\x0a\x20\x20\x20\x20vec3\x20disPos\x20=\x20upDir\x20*\x20centerBump\x20*\x20'+_0x41570f+_0x3daa63(_0x2b8083._0x3f58a6);}exports['HeatLayer']=HeatLayer,Object['defineProperty'](exports,_0x4f1353(0x159),{'value':!![]});
}));
